<html>

<head>
    <title>MagPy4 Help</title>
    <link rel='stylesheet' type='text/css' href='help.css' />
</head>

<body>
    <h1>MagPy4 Help</h1>
    <h2>Overview</h2>
    <p>MagPy4 simplifies the analysis of magnetic field data. Using the program, you can examine the three components
        of the vector magnetic field and the total magnetic field as a function of time. When you have identified an
        interesting segment of data, you can apply any one of a series of standard analysis tools to that data. You can
        use the characteristics of the data to choose more natural coordinate systems in which to display the data. You
        can filter the data, perform Fourier analysis of the data, and so on.</p>
    <h2>Menu Commands</h2>
    <h3>File</h3>
    <p>The File menu allows you to open and add flat files, and to open CDF files.</p>
    <h3>Tools &gt; Data</h3>
    <p>The Data window allows you to view all the information about the data contained in the files you opened. It also
        allows you to choose a specific time or a specific data row and to view the corresponding magnetic field data.</p>
    <h3>Tools &gt; Plot</h3>
    <p>The Plot window allows you to add plots to the program's main window or to remove plots that are already
        displayed there. You can also clear all plots from the window. You can choose which components of the magnetic
        field data to plot.</p>
    <h3>Tools &gt; Spectra</h3>
    <p>After selecting a time interval in the program's main window, the Spectra window displays the power spectrum of
        the magnetic field signals, the coherence, and the phase difference between any two components of the magnetic
        field. The Spectra windows also allows you to perform wave analysis.</p>
    <h4>Power spectrum</h4>
    <p>A digital signal containing <i>n</i> points sampled every <i>&Delta;t</i> seconds is <i>n&Delta;t</i> seconds
        long. The lowest frequency that can be accurately determined in this finite length time series is (<i>n&Delta;t)<sup>-1</sup></i>
        and the highest is (<i>2&Delta;t)<sup>-1</sup></i> because two data points are required to define a wave. This
        maximum frequency is called the Nyquist frequency. Fast Fourier transform routines can transform a time series
        of fluctuations of one component of magnetic field signals into a series of cosine and sine amplitudes
        <i>C<sub>0</sub></i>, <i>C<sub>1</sub></i>, &hellip;, <i>C<sub>n/2-1</sub></i> and
        <i>S<sub>1</sub></i>, <i>S<sub>2</sub></i>, &hellip;, <i>S<sub>n/2</sub></i>.</p>
    <p>If there are three orthogonal measurements of wave amplitudes in direction x, y, and z, we can form the
        cospectral matrix of variances and cross variances at each frequency <i>i</i>:</p>
    <p class='center'><img src='figure1.png' alt='Figure 1' height='73' width='364'></p>
    <p>This matrix is the cospectral density of the signal.</p>
    <p>If you were to plot the sum of the diagonal terms (the trace) versus frequency, perhaps averaging over frequency
        to provide statistical accuracy or stability of the estimates, the plot would show the power spectral density
        of the signal versus frequency. This is called the power spectrum.</p>
    <h4>Wave Analysis</h4>
    <p>The cospectrum matrix is the real part of the spectrum matrix. The imaginary part of the spectrum matrix, which
        is called the quaspectrum matrix, can be calculated at each frequency i by:</p>
    <p class='center'><img src='figure2.png' alt='Figure 2' height='64' width='361'></p>
    <p>These two matrixes give much information about wave properties. These properties were exploited by Born
        and Wolf (1970) to analyze optical signals and by Rankin and Kurtz (1970) to analyze micropulsations. Means
        (1972) showed that the direction of propagation can be directly obtained from the matrix <i>Q<sub>i</sub></i>.</p>
    <h4>Coherence</h4>
    <p>The coherence between signals 1 and signals 2 at each frequency <i>i</i> is defined by:</p>
    <p class='center'><img src='figure3.png' alt='Figure 3' height='52' width='190'></p>
    <p>where <i>C<sub>i,mn</sub></i> is the mn-component of the cospectrum at each frequency <i>i</i> and <i>Q<sub>i,mn</sub></i>
        is the mn-component of the quaspectrum at each frequency <i>i</i>.</p>
    <h4>Phase</h4>
    <p>Phase is the difference, expressed in degrees or radians, between two waves having the same frequency and
        referenced to the same point in time. The phase difference between signal 1 and signal 2 at each frequency <i>i</i>
        can be defined by:</p>
    <p class='center'><img src='figure4.png' alt='Figure 4' height='30' width='179'></p>
    <h3>Tools &gt; Detrend</h3>
    <p> After selecting a time interval in the main window, each variable in the selected plot(s) is
        detrended independently using the least-squares fit method and plotted in a separate window.
        Additionally, buttons for the Spectra, Dynamic Spectra, and Dynamic Coherence/Phase tools are
        present in this window that, when clicked, automatically apply these tools to the detrended data. 
        The selected region can be adjusted even further once the tools have been opened. Clicking on
        the plots when no tool is open in this window will open the Trace Stats tool and apply it
        to the detrended data.
    </p>
    <h3>Tools &gt; Trajectory Analysis</h3>
    <p> If position data (in Cartesian coordinates) is loaded for the current dataset,
        the Trajectory Analysis tool is enabled as a menu option. Once activated, the
        user can select a time region to generate altitude profiles and orbit plots for.
        For the orbit plots, the user has the option of plotting time ticks and/or projections
        of the magnetic field lines onto the selected view plane. The user has the option
        of modifying the field line scale relative to the position units and to set the
        tick interval for both the magnetic field lines and time ticks show on the plot.
        Additionally, the projection of the field lines onto the terminator plane can
        also be plotted.
    </p>
    <h3>Tools &gt; Dynamic Analysis Tools</h3>
    <p> Many of the calculations from the Spectra tool can be calculated for
        multiple overlapping, consecutive time regions of equal length to form a 
        time series. Using this time series, a plot can be formed where the y-axis
        represents the frequency, the x-axis represents the time of the calculation,
        and the calculated values are mapped to a color.
        <br></br>
        The FFT interval parameter represents the number of data points that
        will be used to compute the values for a single column in the plot. The
        FFT shift parameter represents the number of data points to move forward
        after each iteration. The bandwidth parameter represents the number of spectral
        matrices that will be averaged together for each frequency before the
        rest of the necessary computations are performed.

        <h4> Dynamic Spectra</h4>
        <p> Within the Dynamic Spectra tool, the user can set the log power
            range represented by the color scale. Values above or below the user-set
            values are mapped to the maximum and minimum values respectively.
            Besides the selected plot variables, the user can also calculate the
            sum of the power spectra and the power spectra of the magnitude of
            the field vectors. These options are located within the data variable
            option box as '|Px + Py + Pz - Pt|', '|Px+Py+Pz|', and 'Pt'.
        </p>
        <h4> Dynamic Coherence/Phase</h4>
        <p>
            Within the Dynamic Coherence/Phase tool, the user can select the
            variable pairs to calculate coherence and phase for, and each of these
            calculations is plotted in a separate tab.
        </p>
        <h4> Dynamic Wave Analysis</h4>
        <p> Within the Dynamic Wave Analysis tool, the user can generate plots
            for the ellipticity, propagation angle, azimuth angle, power spectra
            trace, and compressional power for a given vector. The user can
            also specify the minimum/maximum values for the color scale for each
            plot.
        </p>
    </p>
    <h3>Tools &gt; Edit</h3>
    <p>The Edit window allows you to perform matrix rotation and filtering. You can either click the Custom Rotation
        button to specify a custom rotation or click the Minimum Variance button to calculate the minimum variance
        matrix, and then transform the magnetic field vector to the new coordinate. You can also click the Filter
        button to filter the data. Additionally, new variables can be created using existing variables through
        simple arithmetic operations in the Calculate tool. </p>
    <h4>Minimum Variance</h4>
    <p>By solving an eigenvalue problem, it is possible to calculate the rotation matrix that rotates a vector time
        series into a coordinate system in which the direction of the coordinate axes are those of the maximum
        variance, the minimum variance, and an intermediate variance. The eigenvectors are the rows of the
        transformation matrix and the eigenvalues are the variances along each direction. These directions are called
        the principal axes. The system is also called the minimum variance coordinate system. It can often be used at
        the magnetopause, but not at shocks. Usually, the direction in which the magnetic field has a minimum variance
        is the direction normal to the magnetopause.</p>
    <p>Assume the data set you choose is [<b><i>B<sub>1</sub></i></b>, <b><i>B<sub>2</sub></i></b>,
        &hellip;, <b><i>B<sub>N</sub></i></b>] and construct a variance matrix <b><i>M</i></b>. Nine terms of <b><i>M</i></b>
        are <i>m<sub>ij</sub></i>
        (i and j represent the x, y, and z components). Assume the eigenvalues of <i>M</i> are <i>&lambda;<sub>&mu;</sub></i>
        (<i>&mu;</i>=1,2,3) and the eigenvectors that form the transformation matrix are <b><i>V<sub>&mu;</sub></i></b>.</p>
    <p class='center'><img src='figure5.png' alt='Figure 5' height='57' width='119'></p>
    <p class='center'><img src='figure6.png' alt='Figure 6' height='24' width='171'></p>
    <p class='center'><b><i>M</i></b><b><i>V<sub>&mu;</sub></i></b> = <i>&lambda;<sub>&mu;</sub></i><b><i>V<sub>&mu;</sub></i></b>.</p>
    <h3>Options</h3>
    <p>The Options menu allows you to change the style of the plot. You can choose to scale the y-range of the data
        to the current time selection, to draw smooth, antialiased lines, to bridge the gaps between data, and to
        draw only data points rathern than lines between those points.</p>
    <h2>Main Plot Window</h2>
    <h3>Time Interval Selection Bar</h3>
    <p>The time interval selection bar allows you to change the time interval of the data plotted in the program's
        main window. The top bar controls the start time and the bottom bar controls the stop time.</p>
    <h3>Trace Stats</h3>
    <p>The Trace Stats window appears when you click the start and stop time you are interested in on the main
        plotting window. It shows you the minimum value, maximum value, mean value, median value, and standard
        deviation of the magnetic field data in the time interval you choose.</p>
    <p>Multiple regions can be selected to perform this computation on by holding the CTRL key while selecting
        a new region. </p>
    <p>Suppose [<i>x<sub>1</sub></i>, <i>x<sub>2</sub></i>, &hellip;, <i>x<sub>N</sub></i>] is the data set of one
        component of the vector magnetic field or the total magnetic field in the time interval you choose. Minimum
        is the smallest value of this data set and maximum is the largest value. The median is the value separating
        the higher half from the lower half of the data set. Suppose the mean value is <i>&mu;</i> and the standard
        deviation is <i>&sigma;</i>, then:</p>
    <p class='center'><img src='figure7.png' alt='Figure 7' height='57' width='78'></p>
    <p class='center'><img src='figure8.png' alt='Figure 8' height='75' width='130'></p>
</body>

</html>